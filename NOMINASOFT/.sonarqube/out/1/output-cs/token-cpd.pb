≠-
LX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\ADO_SQLServer\AfpSQLServer.cs
	namespace 	
Capa
 
. 
_4_Persistencia 
. 
ADO_SQLServer ,
{ 
public 

class 
AfpSQLServer 
: 
IAfp  $
{ 
private 
readonly 
GestorSQLServer (
	gestorSQL) 2
;2 3
public 
AfpSQLServer 
( 
IGestorAccesoDatos .
	gestorSQL/ 8
)8 9
{ 	
this 
. 
	gestorSQL 
= 
( 
GestorSQLServer -
)- .
	gestorSQL. 7
;7 8
} 	
public 
List 
< 
Afp 
> 

ListarAfps #
(# $
)$ %
{ 	
List 
< 
Afp 
> 
listaAfp 
=  
new! $
List% )
<) *
Afp* -
>- .
(. /
)/ 0
;0 1
Afp 
afp 
; 
string 
consultaSQL 
=  
$str! 4
;4 5
try 
{ 
SqlDataReader 
resultadoSQL *
=+ ,
	gestorSQL- 6
.6 7
EjecutarConsulta7 G
(G H
consultaSQLH S
)S T
;T U
while 
( 
resultadoSQL #
.# $
Read$ (
(( )
)) *
)* +
{   
afp!! 
=!! 
ObtenerDatosAfp!! )
(!!) *
resultadoSQL!!* 6
)!!6 7
;!!7 8
listaAfp"" 
."" 
Add""  
(""  !
afp""! $
)""$ %
;""% &
}## 
}$$ 
catch%% 
(%% 
	Exception%% 
)%% 
{&& 
throw'' 
;'' 
}(( 
return)) 
listaAfp)) 
;)) 
}** 	
public-- 
Afp-- '
BuscarDatosDelAfp_PorNombre-- .
(--. /
string--/ 5
nombre--6 <
)--< =
{.. 	
Afp// 
afp// 
=// 
null// 
;// 
string00 
consultaSQL00 
=00  
$str00! E
+00F G
nombre00H N
+00O P
$str00Q T
;00T U
try11 
{22 
SqlDataReader33 
resultadoSQL33 *
=33+ ,
	gestorSQL33- 6
.336 7
EjecutarConsulta337 G
(33G H
consultaSQL33H S
)33S T
;33T U
if44 
(44 
resultadoSQL44  
.44  !
Read44! %
(44% &
)44& '
)44' (
{55 
afp66 
=66 
ObtenerDatosAfp66 )
(66) *
resultadoSQL66* 6
)666 7
;667 8
}77 
else88 
{99 

MessageBox:: 
.:: 
Show:: #
(::# $
$str::$ 7
)::7 8
;::8 9
};; 
}<< 
catch== 
(== 
	Exception== 
)== 
{>> 
throw?? 
;?? 
}@@ 
returnAA 
afpAA 
;AA 
}BB 	
publicDD 
AfpDD '
BuscarDatosDelAfp_PorCodigoDD .
(DD. /
intDD/ 2
codigoDD3 9
)DD9 :
{EE 	
AfpFF 
afpFF 
=FF 
nullFF 
;FF 
stringGG 
consultaSQLGG 
=GG  
$strGG! D
+GGE F
codigoGGG M
+GGN O
$strGGP S
;GGS T
tryHH 
{II 
SqlDataReaderJJ 
resultadoSQLJJ *
=JJ+ ,
	gestorSQLJJ- 6
.JJ6 7
EjecutarConsultaJJ7 G
(JJG H
consultaSQLJJH S
)JJS T
;JJT U
ifKK 
(KK 
resultadoSQLKK  
.KK  !
ReadKK! %
(KK% &
)KK& '
)KK' (
{LL 
afpMM 
=MM 
ObtenerDatosAfpMM )
(MM) *
resultadoSQLMM* 6
)MM6 7
;MM7 8
}NN 
elseOO 
{PP 

MessageBoxQQ 
.QQ 
ShowQQ #
(QQ# $
$strQQ$ 7
)QQ7 8
;QQ8 9
}RR 
}SS 
catchTT 
(TT 
	ExceptionTT 
)TT 
{UU 
throwVV 
;VV 
}WW 
returnXX 
afpXX 
;XX 
}YY 	
privateZZ 
AfpZZ 
ObtenerDatosAfpZZ #
(ZZ# $
SqlDataReaderZZ$ 1
resultadoSQLZZ2 >
)ZZ> ?
{[[ 	
Afp\\ 
afp\\ 
=\\ 
new\\ 
Afp\\ 
(\\ 
)\\ 
;\\  
afp]] 
.]] 
Id_afp]] 
=]] 
resultadoSQL]] %
.]]% &
GetInt32]]& .
(]]. /
$num]]/ 0
)]]0 1
;]]1 2
afp^^ 
.^^ 
Nombre^^ 
=^^ 
resultadoSQL^^ %
.^^% &
	GetString^^& /
(^^/ 0
$num^^0 1
)^^1 2
;^^2 3
afp__ 
.__  
Porsentaje_descuento__ $
=__% &
resultadoSQL__' 3
.__3 4

GetDecimal__4 >
(__> ?
$num__? @
)__@ A
;__A B
returnaa 
afpaa 
;aa 
}bb 	
}cc 
}dd ¿ú
QX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\ADO_SQLServer\ContratoSQLServer.cs
	namespace 	
Capa
 
. 
_4_Persistencia 
. 
ADO_SQLServer ,
{ 
public 

class 
ContratoSQLServer "
:# $
	IContrato% .
{ 
private 
readonly 
GestorSQLServer (
	gestorSQL) 2
;2 3
public 
ContratoSQLServer  
(  !
IGestorAccesoDatos! 3
	gestorSQL4 =
)= >
{ 	
this 
. 
	gestorSQL 
= 
( 
GestorSQLServer -
)- .
	gestorSQL. 7
;7 8
} 	
public 
void 
CrearContrato !
(! "
Contrato" *
contrato+ 3
)3 4
{ 	
string 
crearContrato  
=! "
$str	# ∞
+
± ≤
$str	 õ
;
õ ú
try 
{ 

SqlCommand 
comando "
;" #
comando   
=   
	gestorSQL   #
.  # $
ObtenerComandoSQL  $ 5
(  5 6
crearContrato  6 C
)  C D
;  D E
comando!! 
.!! 

Parameters!! "
.!!" #
AddWithValue!!# /
(!!/ 0
$str!!0 E
,!!E F
contrato!!G O
.!!O P
AsignacionFamiliar!!P b
)!!b c
;!!c d
comando"" 
."" 

Parameters"" "
.""" #
AddWithValue""# /
(""/ 0
$str""0 8
,""8 9
contrato"": B
.""B C
Cargo""C H
)""H I
;""I J
comando## 
.## 

Parameters## "
.##" #
AddWithValue### /
(##/ 0
$str##0 ?
,##? @
contrato##A I
.##I J
FechaInicio##J U
.##U V
Date##V Z
)##Z [
;##[ \
comando$$ 
.$$ 

Parameters$$ "
.$$" #
AddWithValue$$# /
($$/ 0
$str$$0 =
,$$= >
contrato$$? G
.$$G H
FechaFin$$H P
.$$P Q
Date$$Q U
)$$U V
;$$V W
comando%% 
.%% 

Parameters%% "
.%%" #
AddWithValue%%# /
(%%/ 0
$str%%0 J
,%%J K
contrato%%L T
.%%T U%
HorasContratadasPorSemana%%U n
)%%n o
;%%o p
comando&& 
.&& 

Parameters&& "
.&&" #
AddWithValue&&# /
(&&/ 0
$str&&0 <
,&&< =
contrato&&> F
.&&F G
	ValorHora&&G P
)&&P Q
;&&Q R
comando'' 
.'' 

Parameters'' "
.''" #
AddWithValue''# /
(''/ 0
$str''0 9
,''9 :
contrato''; C
.''C D
Estado''D J
)''J K
;''K L
comando(( 
.(( 

Parameters(( "
.((" #
AddWithValue((# /
(((/ 0
$str((0 9
,((9 :
contrato((; C
.((C D
Afp((D G
.((G H
Id_afp((H N
)((N O
;((O P
comando)) 
.)) 

Parameters)) "
.))" #
AddWithValue))# /
())/ 0
$str))0 >
,))> ?
contrato))@ H
.))H I
Empleado))I Q
.))Q R
Id_empleado))R ]
)))] ^
;))^ _
comando** 
.** 
ExecuteNonQuery** '
(**' (
)**( )
;**) *

MessageBox++ 
.++ 
Show++ 
(++  
$str++  =
)++= >
;++> ?
},, 
catch-- 
(-- 
	Exception-- 
er-- 
)--  
{.. 

MessageBox// 
.// 
Show// 
(//  
$str//  }
+//~ 
er
//Ä Ç
)
//Ç É
;
//É Ñ
}00 
}22 	
public44 
void44 
EditarContrato44 "
(44" #
Contrato44# +
contrato44, 4
,444 5
int446 9
codigoEmpleado44: H
)44H I
{55 	
try77 
{88 

SqlCommand99 
cmd99 
;99 
cmd;; 
=;; 
	gestorSQL;; 
.;;  )
ObtenerComandoDeProcedimiento;;  =
(;;= >
$str;;> R
);;R S
;;;S T
cmd<< 
.<< 

Parameters<< 
.<< 
AddWithValue<< +
(<<+ ,
$str<<, 9
,<<9 :
contrato<<; C
.<<C D
Id_contrato<<D O
)<<O P
;<<P Q
cmd== 
.== 

Parameters== 
.== 
AddWithValue== +
(==+ ,
$str==, A
,==A B
contrato==C K
.==K L
AsignacionFamiliar==L ^
)==^ _
;==_ `
cmd>> 
.>> 

Parameters>> 
.>> 
AddWithValue>> +
(>>+ ,
$str>>, 4
,>>4 5
contrato>>6 >
.>>> ?
Cargo>>? D
)>>D E
;>>E F
cmd?? 
.?? 

Parameters?? 
.?? 
AddWithValue?? +
(??+ ,
$str??, ;
,??; <
contrato??= E
.??E F
FechaInicio??F Q
)??Q R
;??R S
cmd@@ 
.@@ 

Parameters@@ 
.@@ 
AddWithValue@@ +
(@@+ ,
$str@@, 9
,@@9 :
contrato@@; C
.@@C D
FechaFin@@D L
)@@L M
;@@M N
cmdAA 
.AA 

ParametersAA 
.AA 
AddWithValueAA +
(AA+ ,
$strAA, F
,AAF G
contratoAAH P
.AAP Q%
HorasContratadasPorSemanaAAQ j
)AAj k
;AAk l
cmdBB 
.BB 

ParametersBB 
.BB 
AddWithValueBB +
(BB+ ,
$strBB, 8
,BB8 9
contratoBB: B
.BBB C
	ValorHoraBBC L
)BBL M
;BBM N
cmdCC 
.CC 

ParametersCC 
.CC 
AddWithValueCC +
(CC+ ,
$strCC, 5
,CC5 6
contratoCC7 ?
.CC? @
EstadoCC@ F
)CCF G
;CCG H
cmdDD 
.DD 

ParametersDD 
.DD 
AddWithValueDD +
(DD+ ,
$strDD, 5
,DD5 6
contratoDD7 ?
.DD? @
AfpDD@ C
.DDC D
Id_afpDDD J
)DDJ K
;DDK L
cmdEE 
.EE 

ParametersEE 
.EE 
AddWithValueEE +
(EE+ ,
$strEE, :
,EE: ;
codigoEmpleadoEE< J
)EEJ K
;EEK L
cmdGG 
.GG 
ExecuteNonQueryGG #
(GG# $
)GG$ %
;GG% &

MessageBoxII 
.II 
ShowII 
(II  
$strII  K
)IIK L
;IIL M
}JJ 
catchKK 
(KK 
	ExceptionKK 
erKK 
)KK  
{LL 

MessageBoxMM 
.MM 
ShowMM 
(MM  
$strMM  |
+MM} ~
er	MM Å
)
MMÅ Ç
;
MMÇ É
}NN 
}OO 	
publicQQ 
voidQQ 
AnularContratoQQ "
(QQ" #
ContratoQQ# +
contratoQQ, 4
,QQ4 5
intQQ6 9
codigoEmpleadoQQ: H
)QQH I
{RR 	
stringSS 
anularContratoSS !
=SS" #
$strSS$ _
+SS` a
codigoEmpleadoSSb p
+SSq r
$strSSs u
+SSv w
$strTT% v
+TTw x
codigoEmpleado	TTy á
+
TTà â
$str
TTä ç
+
TTé è
$strUU% 5
;UU5 6
tryWW 
{XX 

SqlCommandYY 
comandoYY "
;YY" #
comando[[ 
=[[ 
	gestorSQL[[ #
.[[# $
ObtenerComandoSQL[[$ 5
([[5 6
anularContrato[[6 D
)[[D E
;[[E F
comando\\ 
.\\ 

Parameters\\ "
.\\" #
AddWithValue\\# /
(\\/ 0
$str\\0 9
,\\9 :
contrato\\; C
.\\C D
Estado\\D J
)\\J K
;\\K L
comando^^ 
.^^ 
ExecuteNonQuery^^ '
(^^' (
)^^( )
;^^) *

MessageBox__ 
.__ 
Show__ 
(__  
$str__  6
)__6 7
;__7 8
}`` 
catchaa 
(aa 
	Exceptionaa 
eraa 
)aa  
{bb 

MessageBoxcc 
.cc 
Showcc 
(cc  
$strcc  |
+cc} ~
er	cc Å
)
ccÅ Ç
;
ccÇ É
}dd 
}ee 	
publicgg 
Contratogg  
MostrarDatosContratogg ,
(gg, -
intgg- 0
CodigoEmpleadogg1 ?
)gg? @
{hh 	
Contratoii 
contratoii 
;ii 
stringjj 
mostrarContratojj "
=jj# $
$str	jj% —
+
jj“ ”
CodigoEmpleado
jj‘ ‚
+
jj„ ‰
$str
jjÂ é
;
jjé è
tryll 
{mm 
SqlDataReadernn 
resultadoSQLnn *
=nn+ ,
	gestorSQLnn- 6
.nn6 7
EjecutarConsultann7 G
(nnG H
mostrarContratonnH W
)nnW X
;nnX Y
ifoo 
(oo 
resultadoSQLoo  
.oo  !
Readoo! %
(oo% &
)oo& '
)oo' (
{pp 
contratoqq 
=qq 
	gestorSQLqq (
.qq( )
ObtenerContratoqq) 8
(qq8 9
resultadoSQLqq9 E
)qqE F
;qqF G
}rr 
elsess 
{tt 
returnuu 
nulluu 
;uu  
}vv 
}ww 
catchxx 
(xx 
	Exceptionxx 
errxx  
)xx  !
{yy 

MessageBoxzz 
.zz 
Showzz 
(zz  
$strzz  8
+zz9 :
errzz; >
)zz> ?
;zz? @
return{{ 
null{{ 
;{{ 
}|| 
return}} 
contrato}} 
;}} 
}~~ 	
public 
Contrato 
GetContrato #
(# $
int$ '
id( *
)* +
{
ÄÄ 	
Contrato
ÅÅ 
contrato
ÅÅ 
;
ÅÅ 
string
ÇÇ 
mostrarContrato
ÇÇ "
=
ÇÇ# $
$strÇÇ% –
+ÇÇ— “
idÇÇ” ’
;ÇÇ’ ÷
try
ÑÑ 
{
ÖÖ 
SqlDataReader
ÜÜ 
resultadoSQL
ÜÜ *
=
ÜÜ+ ,
	gestorSQL
ÜÜ- 6
.
ÜÜ6 7
EjecutarConsulta
ÜÜ7 G
(
ÜÜG H
mostrarContrato
ÜÜH W
)
ÜÜW X
;
ÜÜX Y
if
áá 
(
áá 
resultadoSQL
áá  
.
áá  !
Read
áá! %
(
áá% &
)
áá& '
)
áá' (
{
àà 
contrato
ââ 
=
ââ 
	gestorSQL
ââ (
.
ââ( )
ObtenerContrato
ââ) 8
(
ââ8 9
resultadoSQL
ââ9 E
)
ââE F
;
ââF G
}
ää 
else
ãã 
{
åå 

MessageBox
çç 
.
çç 
Show
çç #
(
çç# $
$str
çç$ =
)
çç= >
;
çç> ?
return
éé 
null
éé 
;
éé  
}
èè 
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
err
ëë  
)
ëë  !
{
íí 

MessageBox
ìì 
.
ìì 
Show
ìì 
(
ìì  
$str
ìì  8
+
ìì9 :
err
ìì; >
)
ìì> ?
;
ìì? @
return
îî 
null
îî 
;
îî 
}
ïï 
return
ññ 
contrato
ññ 
;
ññ 
}
óó 	
public
ôô (
ConceptoIngresoDeDescuento
ôô )&
GetCIDByContrato_Periodo
ôô* B
(
ôôB C
int
ôôC F

idContrato
ôôG Q
,
ôôQ R
int
ôôS V
	idPeriodo
ôôW `
)
ôô` a
{
öö 	(
ConceptoIngresoDeDescuento
õõ &
cid
õõ' *
;
õõ* +
string
úú 
consulta
úú 
=
úú 
$str
úú 
+úú Ä
$str
ùù 3
+
ùù3 4

idContrato
ùù5 ?
+
ùù@ A
$str
ùùB g
+
ùùg h
	idPeriodo
ùùi r
;
ùùr s
try
üü 
{
†† 
SqlDataReader
°° 
resultadoSQL
°° *
=
°°+ ,
	gestorSQL
°°- 6
.
°°6 7
EjecutarConsulta
°°7 G
(
°°G H
consulta
°°H P
)
°°P Q
;
°°Q R
if
¢¢ 
(
¢¢ 
resultadoSQL
¢¢  
.
¢¢  !
Read
¢¢! %
(
¢¢% &
)
¢¢& '
)
¢¢' (
{
££ 
cid
§§ 
=
§§ 

ObtenerCID
§§ $
(
§§$ %
resultadoSQL
§§% 1
)
§§1 2
;
§§2 3
}
•• 
else
¶¶ 
{
ßß 
return
®® 
null
®® 
;
®®  
}
©© 
}
™™ 
catch
´´ 
(
´´ 
	Exception
´´ 
err
´´  
)
´´  !
{
¨¨ 

MessageBox
≠≠ 
.
≠≠ 
Show
≠≠ 
(
≠≠  
$str
≠≠  3
+
≠≠4 5
err
≠≠6 9
)
≠≠9 :
;
≠≠: ;
return
ÆÆ 
null
ÆÆ 
;
ÆÆ 
}
ØØ 
return
∞∞ 
cid
∞∞ 
;
∞∞ 
}
±± 	
public
≥≥ 
List
≥≥ 
<
≥≥ 
Contrato
≥≥ 
>
≥≥ #
GetContratosByPeriodo
≥≥ 3
(
≥≥3 4
Periodo
≥≥4 ;
periodo
≥≥< C
)
≥≥C D
{
¥¥ 	
List
µµ 
<
µµ 
Contrato
µµ 
>
µµ 
	contratos
µµ $
=
µµ% &
new
µµ' *
List
µµ+ /
<
µµ/ 0
Contrato
µµ0 8
>
µµ8 9
(
µµ9 :
)
µµ: ;
;
µµ; <
Contrato
∂∂ 
contrato
∂∂ 
;
∂∂ 

SqlCommand
∑∑ 
cmd
∑∑ 
=
∑∑ 
null
∑∑ !
;
∑∑! "
try
∏∏ 
{
ππ 
cmd
∫∫ 
=
∫∫ 
	gestorSQL
∫∫ 
.
∫∫  +
ObtenerComandoDeProcedimiento
∫∫  =
(
∫∫= >
$str
∫∫> W
)
∫∫W X
;
∫∫X Y
cmd
ªª 
.
ªª 
CommandType
ªª 
=
ªª  !
CommandType
ªª" -
.
ªª- .
StoredProcedure
ªª. =
;
ªª= >
cmd
ºº 
.
ºº 

Parameters
ºº 
.
ºº 
AddWithValue
ºº +
(
ºº+ ,
$str
ºº, 9
,
ºº9 :
periodo
ºº; B
.
ººB C

Id_periodo
ººC M
)
ººM N
;
ººN O
SqlDataReader
ΩΩ 
dr
ΩΩ  
=
ΩΩ! "
cmd
ΩΩ# &
.
ΩΩ& '
ExecuteReader
ΩΩ' 4
(
ΩΩ4 5
)
ΩΩ5 6
;
ΩΩ6 7
while
ææ 
(
ææ 
dr
ææ 
.
ææ 
Read
ææ 
(
ææ 
)
ææ  
)
ææ  !
{
øø 
contrato
¿¿ 
=
¿¿ 
	gestorSQL
¿¿ (
.
¿¿( )
ObtenerContrato
¿¿) 8
(
¿¿8 9
dr
¿¿9 ;
)
¿¿; <
;
¿¿< =
contrato
¡¡ 
.
¡¡ 
Periodo
¡¡ $
=
¡¡% &
periodo
¡¡' .
;
¡¡. /
if
¬¬ 
(
¬¬ 
contrato
¬¬  
.
¬¬  !%
ValidarContratoProcesar
¬¬! 8
(
¬¬8 9
)
¬¬9 :
)
¬¬: ;
{
√√ 
	contratos
ƒƒ !
.
ƒƒ! "
Add
ƒƒ" %
(
ƒƒ% &
contrato
ƒƒ& .
)
ƒƒ. /
;
ƒƒ/ 0
}
≈≈ 
}
∆∆ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
e
»» 
)
»» 
{
…… 

MessageBox
   
.
   
Show
   
(
    
$str
    7
+
  8 9
e
  : ;
)
  ; <
;
  < =
throw
ÀÀ 
;
ÀÀ 
}
ÃÃ 
finally
ÕÕ 
{
ÕÕ 
cmd
ÕÕ 
.
ÕÕ 

Connection
ÕÕ $
.
ÕÕ$ %
Close
ÕÕ% *
(
ÕÕ* +
)
ÕÕ+ ,
;
ÕÕ, -
}
ÕÕ. /
return
ŒŒ 
	contratos
ŒŒ 
;
ŒŒ 
}
œœ 	
private
““ (
ConceptoIngresoDeDescuento
““ *

ObtenerCID
““+ 5
(
““5 6
SqlDataReader
““6 C
resultadoSQL
““D P
)
““P Q
{
”” 	(
ConceptoIngresoDeDescuento
‘‘ &
cid
‘‘' *
=
‘‘+ ,
new
‘‘- 0(
ConceptoIngresoDeDescuento
‘‘1 K
(
‘‘K L
)
‘‘L M
;
‘‘M N
cid
’’ 
.
’’ 
Id_cid
’’ 
=
’’ 
resultadoSQL
’’ %
.
’’% &
GetInt32
’’& .
(
’’. /
$num
’’/ 0
)
’’0 1
;
’’1 2
cid
÷÷ 
.
÷÷ 
MontoHorasExtras
÷÷  
=
÷÷! "
resultadoSQL
÷÷# /
.
÷÷/ 0

GetDecimal
÷÷0 :
(
÷÷: ;
$num
÷÷; <
)
÷÷< =
;
÷÷= >
cid
◊◊ 
.
◊◊ 
MontoHorasAusente
◊◊ !
=
◊◊" #
resultadoSQL
◊◊$ 0
.
◊◊0 1

GetDecimal
◊◊1 ;
(
◊◊; <
$num
◊◊< =
)
◊◊= >
;
◊◊> ?
cid
ÿÿ 
.
ÿÿ "
MontoOtrosDescuentos
ÿÿ $
=
ÿÿ% &
resultadoSQL
ÿÿ' 3
.
ÿÿ3 4

GetDecimal
ÿÿ4 >
(
ÿÿ> ?
$num
ÿÿ? @
)
ÿÿ@ A
;
ÿÿA B
cid
ŸŸ 
.
ŸŸ 
MontoPorAdelanto
ŸŸ  
=
ŸŸ! "
resultadoSQL
ŸŸ# /
.
ŸŸ/ 0

GetDecimal
ŸŸ0 :
(
ŸŸ: ;
$num
ŸŸ; <
)
ŸŸ< =
;
ŸŸ= >
cid
⁄⁄ 
.
⁄⁄  
MontoOtrosIngresos
⁄⁄ "
=
⁄⁄# $
resultadoSQL
⁄⁄% 1
.
⁄⁄1 2

GetDecimal
⁄⁄2 <
(
⁄⁄< =
$num
⁄⁄= >
)
⁄⁄> ?
;
⁄⁄? @
cid
€€ 
.
€€ 
MontoReingreso
€€ 
=
€€  
resultadoSQL
€€! -
.
€€- .

GetDecimal
€€. 8
(
€€8 9
$num
€€9 :
)
€€: ;
;
€€; <
Periodo
ﬁﬁ 
periodo
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ !
Periodo
ﬁﬁ" )
{
ﬂﬂ 

Id_periodo
‡‡ 
=
‡‡ 
resultadoSQL
‡‡ )
.
‡‡) *
GetInt32
‡‡* 2
(
‡‡2 3
$num
‡‡3 4
)
‡‡4 5
}
·· 
;
·· 
cid
‚‚ 
.
‚‚ 
Periodo
‚‚ 
=
‚‚ 
periodo
‚‚ !
;
‚‚! "
Contrato
„„ 
contrato
„„ 
=
„„ 
new
„„  #
Contrato
„„$ ,
{
‰‰ 
Id_contrato
ÂÂ 
=
ÂÂ 
resultadoSQL
ÂÂ *
.
ÂÂ* +
GetInt32
ÂÂ+ 3
(
ÂÂ3 4
$num
ÂÂ4 6
)
ÂÂ6 7
}
ÊÊ 
;
ÊÊ 
cid
ÁÁ 
.
ÁÁ 
Contrato
ÁÁ 
=
ÁÁ 
contrato
ÁÁ #
;
ÁÁ# $
return
ËË 
cid
ËË 
;
ËË 
}
ÍÍ 	
}
ÌÌ 
}ÓÓ Ω9
QX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\ADO_SQLServer\EmpleadoSQLServer.cs
	namespace 	
Capa
 
. 
_4_Persistencia 
. 
ADO_SQLServer ,
{ 
public 

class 
EmpleadoSQLServer "
:# $
	IEmpleado% .
{ 
private 
readonly 
GestorSQLServer (
	gestorSQL) 2
;2 3
public 
EmpleadoSQLServer  
(  !
IGestorAccesoDatos! 3
	gestorSQL4 =
)= >
{ 	
this 
. 
	gestorSQL 
= 
( 
GestorSQLServer -
)- .
	gestorSQL. 7
;7 8
} 	
public 
Empleado  
BuscarEmpleadoPorDNI ,
(, -
string- 3
DNI4 7
)7 8
{ 	
Empleado 
empleado 
; 
string 
consultaSQL 
=  
$str! G
+H I
DNIJ M
+N O
$strP S
;S T
try 
{ 
SqlDataReader 
resultadoSQL *
=+ ,
	gestorSQL- 6
.6 7
EjecutarConsulta7 G
(G H
consultaSQLH S
)S T
;T U
if 
( 
resultadoSQL  
.  !
Read! %
(% &
)& '
)' (
{ 
empleado 
= !
ObtenerDatosEmpleaods 4
(4 5
resultadoSQL5 A
)A B
;B C
}   
else!! 
{"" 
return## 
null## 
;##  
}$$ 
resultadoSQL%% 
.%% 
Close%% "
(%%" #
)%%# $
;%%$ %
}&& 
catch'' 
('' 
	Exception'' 
)'' 
{(( 
throw)) 
;)) 
}** 
return++ 
empleado++ 
;++ 
},, 	
public-- 
List-- 
<-- 
Contrato-- 
>-- 
obtenerContratos-- .
(--. /
int--/ 2

idEmpleado--3 =
)--= >
{.. 	
List// 
<// 
Contrato// 
>// 
	contratos// $
=//% &
new//' *
List//+ /
</// 0
Contrato//0 8
>//8 9
(//9 :
)//: ;
;//; <
Contrato00 
contrato00 
;00 
string11 
consultaSQL11 
=11  
$str11! M
+11N O

idEmpleado11P Z
+11[ \
$str11] y
;11y z
try22 
{33 
SqlDataReader44 
resultadoSQL244 +
=44, -
	gestorSQL44. 7
.447 8
EjecutarConsulta448 H
(44H I
consultaSQL44I T
)44T U
;44U V
while55 
(55 
resultadoSQL255 $
.55$ %
Read55% )
(55) *
)55* +
)55+ ,
{66 
contrato77 
=77 
	gestorSQL77 (
.77( )
ObtenerContrato77) 8
(778 9
resultadoSQL2779 F
)77F G
;77G H
	contratos88 
.88 
Add88 !
(88! "
contrato88" *
)88* +
;88+ ,
}99 
resultadoSQL2:: 
.:: 
Close:: #
(::# $
)::$ %
;::% &
};; 
catch<< 
(<< 
	Exception<< 
er<< 
)<<  
{== 

MessageBox>> 
.>> 
Show>> 
(>>  
$str>>  )
+>>) *
er>>* ,
)>>, -
;>>- .
}?? 
return@@ 
	contratos@@ 
;@@ 
}AA 	
publicBB 
EmpleadoBB 
BuscarEmpleadoBB &
(BB& '
intBB' *
idBB+ -
)BB- .
{CC 	
EmpleadoDD 
empleadoDD 
;DD 
stringEE 
consultaSQLEE 
=EE  
$strEE! N
+EEO P
idEEQ S
+EET U
$strEEV Y
;EEY Z
tryFF 
{GG 
SqlDataReaderHH 
resultadoSQLHH *
=HH+ ,
	gestorSQLHH- 6
.HH6 7
EjecutarConsultaHH7 G
(HHG H
consultaSQLHHH S
)HHS T
;HHT U
ifII 
(II 
resultadoSQLII  
.II  !
ReadII! %
(II% &
)II& '
)II' (
{JJ 
empleadoKK 
=KK !
ObtenerDatosEmpleaodsKK 4
(KK4 5
resultadoSQLKK5 A
)KKA B
;KKB C
}LL 
elseMM 
{NN 
returnOO 
nullOO 
;OO  
}PP 
resultadoSQLQQ 
.QQ 
CloseQQ "
(QQ" #
)QQ# $
;QQ$ %
}RR 
catchSS 
(SS 
	ExceptionSS 
)SS 
{TT 
throwUU 
;UU 
}VV 
returnWW 
empleadoWW 
;WW 
}XX 	
privateYY 
EmpleadoYY !
ObtenerDatosEmpleaodsYY .
(YY. /
SqlDataReaderYY/ <
resultadoSQLYY= I
)YYI J
{ZZ 	
Empleado[[ 
empleado[[ 
=[[ 
new[[  #
Empleado[[$ ,
([[, -
)[[- .
;[[. /
empleado\\ 
.\\ 
Id_empleado\\  
=\\! "
resultadoSQL\\# /
.\\/ 0
GetInt32\\0 8
(\\8 9
$num\\9 :
)\\: ;
;\\; <
empleado]] 
.]] 
Dni]] 
=]] 
resultadoSQL]] '
.]]' (
	GetString]]( 1
(]]1 2
$num]]2 3
)]]3 4
;]]4 5
empleado^^ 
.^^ 
	Direccion^^ 
=^^  
resultadoSQL^^! -
.^^- .
	GetString^^. 7
(^^7 8
$num^^8 9
)^^9 :
;^^: ;
empleado__ 
.__ 
EstadoCivil__  
=__! "
resultadoSQL__# /
.__/ 0
	GetString__0 9
(__9 :
$num__: ;
)__; <
;__< =
empleado`` 
.`` 
FechaNacimiento`` $
=``% &
resultadoSQL``' 3
.``3 4
GetDateTime``4 ?
(``? @
$num``@ A
)``A B
;``B C
empleadoaa 
.aa 
GradoAcademicoaa #
=aa$ %
resultadoSQLaa& 2
.aa2 3
	GetStringaa3 <
(aa< =
$numaa= >
)aa> ?
;aa? @
empleadobb 
.bb 
Telefonobb 
=bb 
resultadoSQLbb  ,
.bb, -
	GetStringbb- 6
(bb6 7
$numbb7 8
)bb8 9
;bb9 :
empleadocc 
.cc 
Nombrecc 
=cc 
resultadoSQLcc *
.cc* +
	GetStringcc+ 4
(cc4 5
$numcc5 6
)cc6 7
;cc7 8
returndd 
empleadodd 
;dd 
}ee 	
}gg 
}hh òV
OX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\ADO_SQLServer\GestorSQLServer.cs
	namespace 	
Capa
 
. 
_4_Persistencia 
. 
ADO_SQLServer ,
{ 
public 

class 
GestorSQLServer  
:! "
IGestorAccesoDatos# 5
{ 
private 
SqlConnection 
conexion &
;& '
private 
SqlTransaction 
transaccion *
;* +
public 
void 
AbrirConexion !
(! "
)" #
{ 	
try 
{ 
conexion 
= 
new 
SqlConnection ,
(, -
)- .
;. /
conexion 
. 
ConnectionString )
=* +
$str, v
;v w
conexion 
. 
Open 
( 
) 
;  
} 
catch 
( 
	Exception 
err  
)  !
{ 

MessageBox 
. 
Show 
(  
$str  L
+M N
errO R
)R S
;S T
throw   
;   
}!! 
}## 	
public%% 
void%% 
CerrarConexion%% "
(%%" #
)%%# $
{&& 	
try'' 
{(( 
conexion)) 
.)) 
Close)) 
()) 
)))  
;))  !
}** 
catch++ 
(++ 
	Exception++ 
err++  
)++  !
{,, 

MessageBox-- 
.-- 
Show-- 
(--  
$str--  S
+--T U
err--V Y
)--Y Z
;--Z [
throw.. 
;.. 
}// 
}11 	
public33 
void33 
IniciarTransaccion33 &
(33& '
)33' (
{44 	
try55 
{66 
AbrirConexion77 
(77 
)77 
;77  
transaccion88 
=88 
conexion88 &
.88& '
BeginTransaction88' 7
(887 8
)888 9
;889 :
}99 
catch:: 
(:: 
	Exception:: 
err::  
)::  !
{;; 

MessageBox<< 
.<< 
Show<< 
(<<  
$str<<  W
+<<X Y
err<<Z ]
)<<] ^
;<<^ _
throw== 
;== 
}>> 
}?? 	
publicAA 
voidAA 
TerminarTransaccionAA '
(AA' (
)AA( )
{BB 	
tryCC 
{DD 
transaccionEE 
.EE 
CommitEE "
(EE" #
)EE# $
;EE$ %
conexionFF 
.FF 
CloseFF 
(FF 
)FF  
;FF  !
}GG 
catchHH 
(HH 
	ExceptionHH 
errHH  
)HH  !
{II 

MessageBoxJJ 
.JJ 
ShowJJ 
(JJ  
$strJJ  X
+JJY Z
errJJ[ ^
)JJ^ _
;JJ_ `
throwKK 
;KK 
}LL 
}MM 	
publicOO 
voidOO 
CancelarTransaccionOO '
(OO' (
)OO( )
{PP 	
tryQQ 
{RR 
transaccionSS 
.SS 
RollbackSS $
(SS$ %
)SS% &
;SS& '
conexionTT 
.TT 
CloseTT 
(TT 
)TT  
;TT  !
}UU 
catchVV 
(VV 
	ExceptionVV 
errVV  
)VV  !
{WW 

MessageBoxXX 
.XX 
ShowXX 
(XX  
$strXX  X
+XXY Z
errXX[ ^
)XX^ _
;XX_ `
throwYY 
;YY 
}ZZ 
}[[ 	
public]] 
SqlDataReader]] 
EjecutarConsulta]] -
(]]- .
string]]. 4
sentenciaSQL]]5 A
)]]A B
{^^ 	
try__ 
{`` 

SqlCommandaa 

comandoSQLaa %
=aa& '
conexionaa( 0
.aa0 1
CreateCommandaa1 >
(aa> ?
)aa? @
;aa@ A
ifbb 
(bb 
transaccionbb 
!=bb  "
nullbb# '
)bb' (

comandoSQLcc 
.cc 
Transactioncc *
=cc+ ,
transaccioncc- 8
;cc8 9

comandoSQLdd 
.dd 
CommandTextdd &
=dd' (
sentenciaSQLdd) 5
;dd5 6

comandoSQLee 
.ee 
CommandTypeee &
=ee' (
CommandTypeee) 4
.ee4 5
Textee5 9
;ee9 :
returnff 

comandoSQLff !
.ff! "
ExecuteReaderff" /
(ff/ 0
)ff0 1
;ff1 2
}gg 
catchhh 
(hh 
	Exceptionhh 
errhh  
)hh  !
{ii 

MessageBoxjj 
.jj 
Showjj 
(jj  
$strjj  Q
+jjR S
errjjT W
)jjW X
;jjX Y
throwkk 
;kk 
}ll 
}mm 	
publicoo 

SqlCommandoo 
ObtenerComandoSQLoo +
(oo+ ,
stringoo, 2
sentenciaSQLoo3 ?
)oo? @
{pp 	
tryqq 
{rr 

SqlCommandss 

comandoSQLss %
=ss& '
conexionss( 0
.ss0 1
CreateCommandss1 >
(ss> ?
)ss? @
;ss@ A
iftt 
(tt 
transacciontt 
!=tt  "
nulltt# '
)tt' (

comandoSQLuu 
.uu 
Transactionuu *
=uu+ ,
transaccionuu- 8
;uu8 9

comandoSQLvv 
.vv 
CommandTextvv &
=vv' (
sentenciaSQLvv) 5
;vv5 6

comandoSQLww 
.ww 
CommandTypeww &
=ww' (
CommandTypeww) 4
.ww4 5
Textww5 9
;ww9 :
returnxx 

comandoSQLxx !
;xx! "
}yy 
catchzz 
(zz 
	Exceptionzz 
errzz  
)zz  !
{{{ 

MessageBox|| 
.|| 
Show|| 
(||  
$str||  G
+||H I
err||J M
)||M N
;||N O
throw}} 
;}} 
}~~ 
} 	
public
ÅÅ 

SqlCommand
ÅÅ +
ObtenerComandoDeProcedimiento
ÅÅ 7
(
ÅÅ7 8
string
ÅÅ8 >%
procedimientoAlmacenado
ÅÅ? V
)
ÅÅV W
{
ÇÇ 	
try
ÉÉ 
{
ÑÑ 

SqlCommand
ÖÖ 

comandoSQL
ÖÖ %
=
ÖÖ& '
new
ÖÖ( +

SqlCommand
ÖÖ, 6
(
ÖÖ6 7%
procedimientoAlmacenado
ÖÖ7 N
,
ÖÖN O
conexion
ÖÖP X
)
ÖÖX Y
;
ÖÖY Z
if
ÜÜ 
(
ÜÜ 
transaccion
ÜÜ 
!=
ÜÜ  "
null
ÜÜ# '
)
ÜÜ' (

comandoSQL
áá 
.
áá 
Transaction
áá *
=
áá+ ,
transaccion
áá- 8
;
áá8 9

comandoSQL
àà 
.
àà 
CommandType
àà &
=
àà' (
CommandType
àà) 4
.
àà4 5
StoredProcedure
àà5 D
;
ààD E
return
ââ 

comandoSQL
ââ !
;
ââ! "
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
err
ãã  
)
ãã  !
{
åå 

MessageBox
çç 
.
çç 
Show
çç 
(
çç  
$str
çç  G
+
ççH I
err
ççJ M
)
ççM N
;
ççN O
throw
éé 
;
éé 
}
èè 
}
êê 	
public
ëë 
Contrato
ëë 
ObtenerContrato
ëë '
(
ëë' (
SqlDataReader
ëë( 5
resultadoSQL
ëë6 B
)
ëëB C
{
íí 	
Contrato
ìì 
contrato
ìì 
=
ìì 
new
ìì  #
Contrato
ìì$ ,
(
ìì, -
)
ìì- .
;
ìì. /
contrato
îî 
.
îî 
Id_contrato
îî  
=
îî! "
resultadoSQL
îî# /
.
îî/ 0
GetInt32
îî0 8
(
îî8 9
$num
îî9 :
)
îî: ;
;
îî; <
contrato
ïï 
.
ïï  
AsignacionFamiliar
ïï '
=
ïï( )
resultadoSQL
ïï* 6
.
ïï6 7

GetBoolean
ïï7 A
(
ïïA B
$num
ïïB C
)
ïïC D
;
ïïD E
contrato
ññ 
.
ññ 
Cargo
ññ 
=
ññ 
resultadoSQL
ññ )
.
ññ) *
	GetString
ññ* 3
(
ññ3 4
$num
ññ4 5
)
ññ5 6
;
ññ6 7
contrato
óó 
.
óó 
FechaInicio
óó  
=
óó! "
resultadoSQL
óó# /
.
óó/ 0
GetDateTime
óó0 ;
(
óó; <
$num
óó< =
)
óó= >
;
óó> ?
contrato
òò 
.
òò 
FechaFin
òò 
=
òò 
resultadoSQL
òò  ,
.
òò, -
GetDateTime
òò- 8
(
òò8 9
$num
òò9 :
)
òò: ;
;
òò; <
contrato
ôô 
.
ôô '
HorasContratadasPorSemana
ôô .
=
ôô/ 0
resultadoSQL
ôô1 =
.
ôô= >
GetInt32
ôô> F
(
ôôF G
$num
ôôG H
)
ôôH I
;
ôôI J
contrato
öö 
.
öö 
	ValorHora
öö 
=
öö  
resultadoSQL
öö! -
.
öö- .
GetInt32
öö. 6
(
öö6 7
$num
öö7 8
)
öö8 9
;
öö9 :
contrato
õõ 
.
õõ 
Estado
õõ 
=
õõ 
resultadoSQL
õõ *
.
õõ* +

GetBoolean
õõ+ 5
(
õõ5 6
$num
õõ6 7
)
õõ7 8
;
õõ8 9
Afp
úú 
afp
úú 
=
úú 
new
úú 
Afp
úú 
(
úú 
)
úú 
;
úú  
afp
ùù 
.
ùù 
Id_afp
ùù 
=
ùù 
resultadoSQL
ùù %
.
ùù% &
GetInt32
ùù& .
(
ùù. /
$num
ùù/ 0
)
ùù0 1
;
ùù1 2
contrato
ûû 
.
ûû 
Afp
ûû 
=
ûû 
afp
ûû 
;
ûû 
if
üü 
(
üü 
!
üü 
contrato
üü 
.
üü %
ValidarVigenciaContrato
üü 1
(
üü1 2
)
üü2 3
)
üü3 4
{
†† 
contrato
°° 
.
°° 
Estado
°° 
=
°°  !
false
°°" '
;
°°' (
}
¢¢ 
return
££ 
contrato
££ 
;
££ 
}
•• 	
}
¶¶ 
}ßß ÉG
MX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\ADO_SQLServer\PagoSQLServer.cs
	namespace 	
Capa
 
. 
_4_Persistencia 
. 
ADO_SQLServer ,
{ 
class 	
PagoSQLServer
 
: 
IPago 
{ 
private 
readonly 
GestorSQLServer (
	gestorSQL) 2
;2 3
public 
PagoSQLServer 
( 
IGestorAccesoDatos /
	gestorSQL0 9
)9 :
{ 	
this 
. 
	gestorSQL 
= 
( 
GestorSQLServer -
)- .
	gestorSQL. 7
;7 8
} 	
public 
bool 
registerPago  
(  !
Pago! %
pago& *
)* +
{ 	
bool 
insert 
= 
false 
;  

SqlCommand 
cmd 
= 
null !
;! "
try 
{ 
cmd 
= 
	gestorSQL 
.  )
ObtenerComandoDeProcedimiento  =
(= >
$str> L
)L M
;M N
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, :
,: ;
pago< @
.@ A
FechaActualA L
)L M
;M N
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, A
,A B
pagoC G
.G H#
MontoAsignacionFamiliarH _
)_ `
;` a
cmd 
. 

Parameters 
. 
AddWithValue +
(+ ,
$str, ;
,; <
pago= A
.A B
DescuentAFPB M
)M N
;N O
cmd   
.   

Parameters   
.   
AddWithValue   +
(  + ,
$str  , ;
,  ; <
pago  = A
.  A B
SueldoMinimo  B N
)  N O
;  O P
cmd!! 
.!! 

Parameters!! 
.!! 
AddWithValue!! +
(!!+ ,
$str!!, B
,!!B C
pago!!D H
.!!H I
PorcentajeDescuento!!I \
)!!\ ]
;!!] ^
cmd"" 
."" 

Parameters"" 
."" 
AddWithValue"" +
(""+ ,
$str"", 8
,""8 9
pago"": >
.""> ?
	ValorHora""? H
)""H I
;""I J
cmd## 
.## 

Parameters## 
.## 
AddWithValue## +
(##+ ,
$str##, 8
,##8 9
pago##: >
.##> ?

TotalHoras##? I
)##I J
;##J K
cmd$$ 
.$$ 

Parameters$$ 
.$$ 
AddWithValue$$ +
($$+ ,
$str$$, 9
,$$9 :
pago$$; ?
.$$? @
Periodo$$@ G
.$$G H

Id_periodo$$H R
)$$R S
;$$S T
cmd%% 
.%% 

Parameters%% 
.%% 
AddWithValue%% +
(%%+ ,
$str%%, :
,%%: ;
pago%%< @
.%%@ A
Contrato%%A I
.%%I J
Id_contrato%%J U
)%%U V
;%%V W
int'' 
i'' 
='' 
cmd'' 
.'' 
ExecuteNonQuery'' +
(''+ ,
)'', -
;''- .
if(( 
((( 
i(( 
>(( 
$num(( 
)(( 
{)) 
insert** 
=** 
true** !
;**! "
}++ 
},, 
catch-- 
(-- 
	Exception-- 
e-- 
)-- 
{.. 

MessageBox// 
.// 
Show// 
(//  
$str//  7
+//8 9
e//: ;
)//; <
;//< =
throw00 
;00 
}11 
finally22 
{22 
cmd22 
.22 

Connection22 $
.22$ %
Close22% *
(22* +
)22+ ,
;22, -
}22. /
return33 
insert33 
;33 
}44 	
public55 
List55 
<55 
Pago55 
>55 
GetPagosByPeriodo55 +
(55+ ,
Periodo55, 3
periodo554 ;
)55; <
{66 	
List77 
<77 
Pago77 
>77 
pagos77 
=77 
new77  
List77! %
<77% &
Pago77& *
>77* +
(77+ ,
)77, -
;77- .
Pago88 
pago88 
;88 
string99 
consulta99 
=99 
$str99 F
+99G H
periodo99I P
.99P Q

Id_periodo99Q [
;99[ \
try;; 
{<< 
SqlDataReader== 
resultadoSQL== *
===+ ,
	gestorSQL==- 6
.==6 7
EjecutarConsulta==7 G
(==G H
consulta==H P
)==P Q
;==Q R
while>> 
(>> 
resultadoSQL>> #
.>># $
Read>>$ (
(>>( )
)>>) *
)>>* +
{?? 
pago@@ 
=@@ 
ObtenerPago@@ &
(@@& '
resultadoSQL@@' 3
)@@3 4
;@@4 5
pagosAA 
.AA 
AddAA 
(AA 
pagoAA "
)AA" #
;AA# $
}BB 
}CC 
catchDD 
(DD 
	ExceptionDD 
errDD  
)DD  !
{EE 

MessageBoxFF 
.FF 
ShowFF 
(FF  
$strFF  3
+FF4 5
errFF6 9
)FF9 :
;FF: ;
returnGG 
newGG 
ListGG 
<GG  
PagoGG  $
>GG$ %
(GG% &
)GG& '
;GG' (
}HH 
returnII 
pagosII 
;II 
}JJ 	
privateKK 
PagoKK 
ObtenerPagoKK  
(KK  !
SqlDataReaderKK! .
resultadoSQLKK/ ;
)KK; <
{LL 	
PagoMM 
pagoMM 
=MM 
newMM 
PagoMM  
(MM  !
)MM! "
;MM" #
pagoNN 
.NN 
Id_pagoNN 
=NN 
resultadoSQLNN '
.NN' (
GetInt32NN( 0
(NN0 1
$numNN1 2
)NN2 3
;NN3 4
pagoOO 
.OO 
FechaActualOO 
=OO 
resultadoSQLOO +
.OO+ ,
GetDateTimeOO, 7
(OO7 8
$numOO8 9
)OO9 :
;OO: ;
pagoPP 
.PP #
MontoAsignacionFamiliarPP (
=PP) *
resultadoSQLPP+ 7
.PP7 8

GetDecimalPP8 B
(PPB C
$numPPC D
)PPD E
;PPE F
pagoQQ 
.QQ 
DescuentAFPQQ 
=QQ 
resultadoSQLQQ +
.QQ+ ,

GetDecimalQQ, 6
(QQ6 7
$numQQ7 8
)QQ8 9
;QQ9 :
pagoRR 
.RR 
SueldoMinimoRR 
=RR 
resultadoSQLRR  ,
.RR, -

GetDecimalRR- 7
(RR7 8
$numRR8 9
)RR9 :
;RR: ;
pagoSS 
.SS 
PorcentajeDescuentoSS $
=SS% &
resultadoSQLSS' 3
.SS3 4

GetDecimalSS4 >
(SS> ?
$numSS? @
)SS@ A
;SSA B
pagoTT 
.TT 
	ValorHoraTT 
=TT 
resultadoSQLTT )
.TT) *

GetDecimalTT* 4
(TT4 5
$numTT5 6
)TT6 7
;TT7 8
pagoUU 
.UU 

TotalHorasUU 
=UU 
resultadoSQLUU *
.UU* +

GetDecimalUU+ 5
(UU5 6
$numUU6 7
)UU7 8
;UU8 9
PeriodoVV 
periodoVV 
=VV 
newVV !
PeriodoVV" )
(VV) *
)VV* +
;VV+ ,
ContratoWW 
contratoWW 
=WW 
newWW  #
ContratoWW$ ,
(WW, -
)WW- .
;WW. /
periodoXX 
.XX 

Id_periodoXX 
=XX  
resultadoSQLXX! -
.XX- .
GetInt32XX. 6
(XX6 7
$numXX7 8
)XX8 9
;XX9 :
contratoYY 
.YY 
Id_contratoYY  
=YY! "
resultadoSQLYY# /
.YY/ 0
GetInt32YY0 8
(YY8 9
$numYY9 :
)YY: ;
;YY; <
pago[[ 
.[[ 
Periodo[[ 
=[[ 
periodo[[ "
;[[" #
pago\\ 
.\\ 
Contrato\\ 
=\\ 
contrato\\ $
;\\$ %
return^^ 
pago^^ 
;^^ 
}`` 	
}aa 
}cc ˙=
PX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\ADO_SQLServer\PeriodoSQLServer.cs
	namespace 	
Capa
 
. 
_4_Persistencia 
. 
ADO_SQLServer ,
{ 
class 	
PeriodoSQLServer
 
: 
IPeriodo %
{ 
private 
readonly 
GestorSQLServer (
	gestorSQL) 2
;2 3
public 
PeriodoSQLServer 
(  
IGestorAccesoDatos  2
	gestorSQL3 <
)< =
{ 	
this 
. 
	gestorSQL 
= 
( 
GestorSQLServer -
)- .
	gestorSQL. 7
;7 8
} 	
public 
bool #
InsertarContratoPeriodo +
(+ ,
int, /

idContrato0 :
,: ;
int< ?
	idPeriodo@ I
)I J
{ 	
string 
consulta 
= 
$str v
;v w
try 
{ 

SqlCommand 
comando "
;" #
comando 
= 
	gestorSQL #
.# $
ObtenerComandoSQL$ 5
(5 6
consulta6 >
)> ?
;? @
comando 
. 

Parameters "
." #
AddWithValue# /
(/ 0
$str0 >
,> ?

idContrato@ J
)J K
;K L
comando   
.   

Parameters   "
.  " #
AddWithValue  # /
(  / 0
$str  0 =
,  = >
	idPeriodo  ? H
)  H I
;  I J
comando!! 
.!! 
ExecuteNonQuery!! '
(!!' (
)!!( )
;!!) *
return"" 
true"" 
;"" 
}## 
catch$$ 
($$ 
	Exception$$ 
er$$ 
)$$  
{%% 

MessageBox&& 
.&& 
Show&& 
(&&  
$str&&  }
+&&~ 
er
&&Ä Ç
)
&&Ç É
;
&&É Ñ
return'' 
false'' 
;'' 
}(( 
}** 	
public++ 
Periodo++ 
GetPeriodoActivo++ '
(++' (
)++( )
{,, 	
List-- 
<-- 
Periodo-- 
>-- 
periodos-- "
=--# $
new--% (
List--) -
<--- .
Periodo--. 5
>--5 6
(--6 7
)--7 8
;--8 9
Periodo// 
periodo// 
;// 
string00 
consultaSQL00 
=00  
$str00! [
;00[ \
bool11 
periodoObtenido11  
=11! "
false11# (
;11( )
try22 
{33 
SqlDataReader44 
resultadoSQL44 *
=44+ ,
	gestorSQL44- 6
.446 7
EjecutarConsulta447 G
(44G H
consultaSQL44H S
)44S T
;44T U
while55 
(55 
resultadoSQL55 #
.55# $
Read55$ (
(55( )
)55) *
)55* +
{66 
periodo77 
=77 
ObtenerDatosPeriodo77 1
(771 2
resultadoSQL772 >
)77> ?
;77? @
periodos88 
.88 
Add88  
(88  !
periodo88! (
)88( )
;88) *
periodoObtenido99 #
=99$ %
true99& *
;99* +
}:: 
if;; 
(;; 
!;; 
resultadoSQL;; !
.;;! "
Read;;" &
(;;& '
);;' (
&&;;) +
!;;, -
periodoObtenido;;- <
);;< =
{<< 
return== 
null== 
;==  
}>> 
}?? 
catch@@ 
(@@ 
	Exception@@ 
)@@ 
{AA 
throwBB 
;BB 
}CC 
returnDD 
periodosDD 
[DD 
$numDD 
]DD 
;DD 
}EE 	
publicFF 
boolFF 
UpdatePeriodoFF !
(FF! "
PeriodoFF" )
periodoFF* 1
)FF1 2
{GG 	
boolHH 
updateHH 
=HH 
falseHH 
;HH 

SqlCommandII 
cmdII 
=II 
nullII !
;II! "
tryJJ 
{KK 
cmdLL 
=LL 
	gestorSQLLL 
.LL  )
ObtenerComandoDeProcedimientoLL  =
(LL= >
$strLL> Q
)LLQ R
;LLR S
cmdMM 
.MM 
CommandTypeMM 
=MM  !
CommandTypeMM" -
.MM- .
StoredProcedureMM. =
;MM= >
cmdNN 
.NN 

ParametersNN 
.NN 
AddWithValueNN +
(NN+ ,
$strNN, 8
,NN8 9
periodoNN: A
.NNA B

Id_periodoNNB L
)NNL M
;NNM N
cmdOO 
.OO 

ParametersOO 
.OO 
AddWithValueOO +
(OO+ ,
$strOO, :
,OO: ;
periodoOO< C
.OOC D
FechaInicioOOD O
)OOO P
;OOP Q
cmdPP 
.PP 

ParametersPP 
.PP 
AddWithValuePP +
(PP+ ,
$strPP, 7
,PP7 8
periodoPP9 @
.PP@ A
FechaFinPPA I
)PPI J
;PPJ K
cmdQQ 
.QQ 

ParametersQQ 
.QQ 
AddWithValueQQ +
(QQ+ ,
$strQQ, 5
,QQ5 6
periodoQQ7 >
.QQ> ?
EstadoQQ? E
)QQE F
;QQF G
intRR 
iRR 
=RR 
cmdRR 
.RR 
ExecuteNonQueryRR +
(RR+ ,
)RR, -
;RR- .
ifSS 
(SS 
iSS 
>SS 
$numSS 
)SS 
{TT 
updateUU 
=UU 
trueUU !
;UU! "
}VV 
}WW 
catchXX 
(XX 
	ExceptionXX 
eXX 
)XX 
{YY 

MessageBoxZZ 
.ZZ 
ShowZZ 
(ZZ  
$strZZ  7
+ZZ8 9
eZZ: ;
)ZZ; <
;ZZ< =
throw[[ 
;[[ 
}\\ 
finally]] 
{]] 
cmd]] 
.]] 

Connection]] $
.]]$ %
Close]]% *
(]]* +
)]]+ ,
;]], -
}]]. /
return^^ 
update^^ 
;^^ 
}__ 	
private`` 
Periodo`` 
ObtenerDatosPeriodo`` +
(``+ ,
SqlDataReader``, 9
resultadoSQL``: F
)``F G
{aa 	
Periodobb 
periodobb 
=bb 
newbb !
Periodobb" )
(bb) *
)bb* +
;bb+ ,
periodocc 
.cc 

Id_periodocc 
=cc  
resultadoSQLcc! -
.cc- .
GetInt32cc. 6
(cc6 7
$numcc7 8
)cc8 9
;cc9 :
periododd 
.dd 
FechaIniciodd 
=dd  !
resultadoSQLdd" .
.dd. /
GetDateTimedd/ :
(dd: ;
$numdd; <
)dd< =
;dd= >
periodoee 
.ee 
FechaFinee 
=ee 
resultadoSQLee +
.ee+ ,
GetDateTimeee, 7
(ee7 8
$numee8 9
)ee9 :
;ee: ;
periodoff 
.ff 
Estadoff 
=ff 
resultadoSQLff )
.ff) *

GetBooleanff* 4
(ff4 5
$numff5 6
)ff6 7
;ff7 8
returnhh 
periodohh 
;hh 
}ii 	
}jj 
}kk Ï
OX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\FabricaDatos\FabricaAbstracta.cs
	namespace

 	
Capa


 
.

 
_4_Persistencia

 
.

 
FabricaDatos

 +
{ 
public 

abstract 
class 
FabricaAbstracta *
{ 
public 
static 
FabricaAbstracta &
crearInstancia' 5
(5 6
)6 7
{ 	
return 
new 
FabricaSQLServer '
(' (
)( )
;) *
} 	
public 
abstract 
IGestorAccesoDatos *"
crearGestorAccesoDatos+ A
(A B
)B C
;C D
public 
abstract 
IAfp 
crearAfpDAO (
(( )
IGestorAccesoDatos) ;
gestorAccesoDatos< M
)M N
;N O
public 
abstract 
	IContrato !
crearContratoDAO" 2
(2 3
IGestorAccesoDatos3 E
gestorAccesoDatosF W
)W X
;X Y
public 
abstract 
	IEmpleado !
crearEmpleadoDAO" 2
(2 3
IGestorAccesoDatos3 E
gestorAccesoDatosF W
)W X
;X Y
public 
abstract 
IPeriodo  
crearPeriodoDAO! 0
(0 1
IGestorAccesoDatos1 C
gestorAccesoDatosD U
)U V
;V W
public 
abstract 
IPago 
crearPagoDAO *
(* +
IGestorAccesoDatos+ =
gestorAccesoDatos> O
)O P
;P Q
} 
} Ñ
OX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\FabricaDatos\FabricaSQLServer.cs
	namespace 	
Capa
 
. 
_4_Persistencia 
. 
FabricaDatos +
{ 
public 

class 
FabricaSQLServer !
:" #
FabricaAbstracta$ 4
{ 
public 
override 
IAfp 
crearAfpDAO (
(( )
IGestorAccesoDatos) ;
gestorAccesoDatos< M
)M N
{ 	
return 
new 
AfpSQLServer #
(# $
gestorAccesoDatos$ 5
)5 6
;6 7
} 	
public 
override 
	IContrato !
crearContratoDAO" 2
(2 3
IGestorAccesoDatos3 E
gestorAccesoDatosF W
)W X
{ 	
return 
new 
ContratoSQLServer (
(( )
gestorAccesoDatos) :
): ;
;; <
} 	
public 
override 
	IEmpleado !
crearEmpleadoDAO" 2
(2 3
IGestorAccesoDatos3 E
gestorAccesoDatosF W
)W X
{ 	
return 
new 
EmpleadoSQLServer (
(( )
gestorAccesoDatos) :
): ;
;; <
} 	
public 
override 
IPeriodo  
crearPeriodoDAO! 0
(0 1
IGestorAccesoDatos1 C
gestorAccesoDatosD U
)U V
{ 	
return 
new 
PeriodoSQLServer '
(' (
gestorAccesoDatos( 9
)9 :
;: ;
} 	
public 
override 
IPago 
crearPagoDAO *
(* +
IGestorAccesoDatos+ =
gestorAccesoDatos> O
)O P
{   	
return!! 
new!! 
PagoSQLServer!! $
(!!$ %
gestorAccesoDatos!!% 6
)!!6 7
;!!7 8
}"" 	
public## 
override## 
IGestorAccesoDatos## *"
crearGestorAccesoDatos##+ A
(##A B
)##B C
{$$ 	
return%% 
new%% 
GestorSQLServer%% &
(%%& '
)%%' (
;%%( )
}&& 	
}'' 
}(( Ù
IX:\Virtuales\Calidad\SOWAD\Capa.4_Persistencia\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str .
). /
]/ 0
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *